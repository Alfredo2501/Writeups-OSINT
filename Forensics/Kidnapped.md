### Kidnapped

```
We have an urgent case on our hands. Our friends at the Police Nationale, in Paris France, have reached out for our assistance. Itâ€™s a case concerning the daughter of a US diplomat residing in France. Recently, Jason Anderson, a former officer with the United States Army Rangers, now diplomat assigned as an intelligence liaison in Paris, received a phone call stating his daughter had been taken. Shortly after, Mr Anderson received a written message in cipher text. We have reason to believe they are closely related.

During the phone call, a man with an Arabic accent spoke to Mr Anderson about having his daughter in captivity. Also stating he has 24 hours to figure out where she is, before he would kill her. Now, this interaction happened 6 hours ago, between that time Mr Anderson contacted police, who reached out to us a few hours after getting stuck on the cipher text.

You assignment is simple, over the next several hours, figure out what the message is behind the cipher text. We need answers quickly, so the police is left with enough time to intervene.

As always, Special Agent K. The Contract is yours, if you choose to accept.

```

### Material of the case

The case gave us the next message:

Y2MgZWQgZWAgZmEgYV8gY0IgZmEgYUMgYV8gY2AgZUMgZWMgZWQgZmEgZmIgZUQgZUMgYUEgXz8gXz8gY2AgZmIgYV8gZmggZUQgZmQgYV8gZUIgZWAgZmggYV8gZUAgZUMgZUQgZmYgYUEgYV8gY2ggYV8gZWcgZWAgZmUgZWQgYV8gZmggZUQgZmQgZmEgYV8gZWMgZWAgZmQgZWYgZWcgZmMgZWQgZmEgYUMgYV8gY2ggZUMgYV8gZmMgZWcgZWQgYV8gZUMgZWQgZmcgZmMgYV8gYmEgYmMgYV8gZWcgZUQgZmQgZmEgZmIgYUEgYV8gZmIgZWcgZWQgYV8gZmYgZWggZUEgZUEgYV8gZWEgZWQgYV8gZUAgZWggZUEgZUEgZWQgZWMgYV8gZWggZUMgYV8gZmMgZWcgZWQgYV8gZUIgZUQgZmIgZmMgYV8gZWYgZmEgZmQgZWQgZmIgZUQgZUIgZWQgYV8gZmYgZWAgZmggYV8gZWggZUIgZWAgZWYgZWggZUMgZWAgZWEgZUEgZWQgYUMgYV8gY2ggYV8gZUAgZUMgZUQgZmYgYV8gZmYgZWcgZWAgZmMgYV8gZmggZUQgZmQgYV8gZWMgZWggZWMgYV8gZmMgZUQgYV8gZUIgZWQgYV8gZWAgZUMgZWMgYV8gZUIgZmggYV8gZWUgZWAgZUIgZWggZUEgZmggYV8gZWggZUMgYV8gY2ggZmEgZWAgZmAgYUEgYV8gZWAgZUMgZWMgYV8gZmIgZUQgYV8gZWMgZUQgYV8gZmggZUQgZmQgYUMgYV8gZGMgZWcgZWQgYV8gZWUgZmQgZUMgZUMgZmggYV8gZmMgZWcgZWggZUMgZWYgYV8gZWggZmIgYUEgYV8gZWQgZmUgZWQgZUMgYV8gZmMgZWcgZUQgZmQgZWYgZWcgYV8gZmggZUQgZmQgYWYgZmEgZWQgYV8gZmIgZmMgZWAgZmEgZWggZUMgZWYgYV8gZWAgZmMgYV8gZmMgZWcgZWggZmIgYV8gZWQgZmcgZWAgZWIgZmMgYV8gZmMgZWQgZmcgZmMgYUEgYV8gZmYgZWcgZWggZWIgZWcgYV8gZmMgZWQgZUEgZUEgZmIgYV8gZmggZUQgZmQgYV8gZWQgZmcgZWAgZWIgZmMgZUEgZmggYV8gZmYgZWcgZWQgZmEgZWQgYV8gZmggZUQgZmQgZmEgYV8gZWMgZWAgZmQgZWYgZWcgZmMgZWQgZmEgYV8gZWggZmIgYUMgYV8gZGMgZWcgZmEgZUQgZmQgZWYgZWcgYV8gZWAgZUEgZUEgYV8gZmMgZWcgZWQgYV8gZUEgZWAgZmggZWQgZmEgZmIgYV8gZUQgZWUgYV8gZWQgZUMgZWIgZUQgZWMgZWggZUMgZWYgYUEgYV8gZmggZUQgZmQgYV8gZmYgZWggZUEgZUEgYV8gZUMgZWQgZmUgZWQgZmEgYV8gZWUgZWggZUMgZWMgYV8gZWcgZWQgZmEgYV8gZWggZUMgYV8gZmMgZWggZUIgZWQgYUMgXz8gXz8gY2AgZWUgZmMgZWQgZmEgYV8gZWAgZUEgZUEgYV8gZmggZUQgZmQgYV8gZWMgZWggZWMgYV8gZmMgZUQgYV8gZUIgZWQgYUEgYV8gY2ggYV8gZmMgZWAgZUAgZWQgYV8gZmIgZUQgYV8gZUIgZmQgZWIgZWcgYV8gZWQgZUMgZT8gZUQgZmggZUIgZWQgZUMgZmMgYV8gZWUgZmEgZUQgZUIgYV8gZUAgZUMgZUQgZmYgZWggZUMgZWYgYV8gZWcgZUQgZmYgYV8gZmggZUQgZmQgYWYgZmEgZWQgYV8gZmIgZmMgZWAgZmEgZWggZUMgZWYgYV8gZWAgZmMgYV8gZmMgZWcgZWggZmIgYV8gZUIgZWQgZmIgZmIgZWAgZWYgZWQgYUMgYV8gY0AgZUMgZUQgZmYgZWggZUMgZWYgYV8gZmMgZWcgZWAgZmMgYV8gZmMgZWcgZWQgYV8gZWAgZUMgZmIgZmYgZWQgZmEgYV8gZUEgZWggZWQgZmIgYV8gZmYgZWggZmMgZWcgZWggZUMgYUEgYV8gZmggZWQgZmMgYV8gZWIgZUQgZUIgZl8gZUEgZWQgZmMgZWQgZUEgZmggYV8gZl8gZUQgZmYgZWQgZmEgZUEgZWQgZmIgZmIgYV8gZmMgZUQgYV8gZWUgZWggZUMgZWMgYV8gZWggZmMgYUMgYV8gZGIgZUQgYV8gZWAgZmIgYV8gZl8gZmEgZUQgZUIgZWggZmIgZWQgZWMgYUEgYV8gZWcgZWQgZmEgZWQgYV8gZWggZmIgYV8gZmggZUQgZmQgZmEgYV8gZWMgZWAgZmQgZWYgZWcgZmMgZWQgZmEgYj8gYV8gZWggZUMgZWIgZWcgZWQgZWMgYUMgZWEgZWAgZmEgZUIgZWAgZUMgYUMgZWUgZWAgZmIgZmMgYV8gY2YgZUQgZUQgZWMgYV8gZUEgZmQgZWIgZUAgYV8gZWUgZWggZUMgZWMgZWggZUMgZWYgYV8gZmQgZmIgYV8gZWggZUMgYV8gZmMgZWggZUIgZWQgYUEgYV8gZmIgZWcgZWQgYWYgZmIgYV8gZmYgZWggZmMgZWcgYV8gZUIgZWQgYV8gZUAgZUMgZUQgZmYgYUMgYV8gY2IgZmEgZmggZWggZUMgZWYgYV8gZWUgZUQgZmEgYV8gZmIgZUQgZUIgZWQgZUQgZUMgZWQgYV8gZmMgZUQgYV8gZWUgZWggZUMgZWMgYV8gZWcgZWQgZmEgYUEgYV8gZmYgZWcgZWggZWIgZWcgYV8gZmggZUQgZmQgYV8gZmYgZWggZUEgZUEgYUEgYV8gZWggZUMgYV8gZl8gZWggZWQgZWIgZWQgZmIgYUMgYV8gZF8gZWggZWQgZWIgZWQgZmIgYV8gZWIgZmEgZWQgZWAgZmMgZWQgZWMgYV8gZUQgZmQgZmMgYV8gZUQgZWUgYV8gZWcgZWQgZmEgYV8gZWUgZUEgZWQgZmIgZWcgYV8gZmYgZWcgZWggZUEgZWQgYV8gZmIgZWcgZWQgYV8gZmYgZWAgZmIgYV8gZmIgZmMgZWggZUEgZUEgYV8gZWAgZUEgZWggZmUgZWQgYUMgYV8gZGMgZWcgZWAgZmMgYWYgZmIgYV8gZmYgZWcgZWAgZmMgYV8gZmggZUQgZmQgYV8gZWYgZWQgZmMgYV8gZWUgZUQgZmEgYV8gZmMgZWcgZWQgYV8gZWcgZUQgZmEgZmEgZUQgZmEgZmIgYV8gZmggZUQgZmQgYV8gZl8gZmQgZmMgYV8gZUIgZWQgYV8gZWAgZUMgZWMgYV8gZUIgZmggYV8gZWUgZWAgZUIgZWggZUEgZmggYV8gZmMgZWcgZmEgZUQgZmQgZWYgZWcgYUMgXz8gXz8gY2UgZmQgZWIgZUAgYV8gZmggZUQgZmQgYUEgYV8gY0IgZmEgYV8gY2AgZUMgZWMgZWQgZmEgZmIgZUQgZUMgYUM=


### Instructions to the case

```
Decipher the message and found Anderson's daughter
The answer is a what3words combination
Sample answer for the flag: banana.truck.hairdresser
```

### Deciphering from Base64

The first thing we can see is the message is encoded in Base64 format, so, we have to decode this format, I'll use: _https://www.base64decode.org/_:

![Base64 decode](https://github.com/user-attachments/assets/87d9e4a1-2d9d-4bfb-893b-1f497bfef6a2)

Full text decode from Base64:
```
cc ed e` fa a_ cB fa aC a_ c` eC ec ed fa fb eD eC aA _? _? c` fb a_ fh eD fd a_ eB e` fh a_ e@ eC eD ff aA a_ ch a_ eg e` fe ed a_ fh eD fd fa a_ ec e` fd ef eg fc ed fa aC a_ ch eC a_ fc eg ed a_ eC ed fg fc a_ ba bc a_ eg eD fd fa fb aA a_ fb eg ed a_ ff eh eA eA a_ ea ed a_ e@ eh eA eA ed ec a_ eh eC a_ fc eg ed a_ eB eD fb fc a_ ef fa fd ed fb eD eB ed a_ ff e` fh a_ eh eB e` ef eh eC e` ea eA ed aC a_ ch a_ e@ eC eD ff a_ ff eg e` fc a_ fh eD fd a_ ec eh ec a_ fc eD a_ eB ed a_ e` eC ec a_ eB fh a_ ee e` eB eh eA fh a_ eh eC a_ ch fa e` f` aA a_ e` eC ec a_ fb eD a_ ec eD a_ fh eD fd aC a_ dc eg ed a_ ee fd eC eC fh a_ fc eg eh eC ef a_ eh fb aA a_ ed fe ed eC a_ fc eg eD fd ef eg a_ fh eD fd af fa ed a_ fb fc e` fa eh eC ef a_ e` fc a_ fc eg eh fb a_ ed fg e` eb fc a_ fc ed fg fc aA a_ ff eg eh eb eg a_ fc ed eA eA fb a_ fh eD fd a_ ed fg e` eb fc eA fh a_ ff eg ed fa ed a_ fh eD fd fa a_ ec e` fd ef eg fc ed fa a_ eh fb aC a_ dc eg fa eD fd ef eg a_ e` eA eA a_ fc eg ed a_ eA e` fh ed fa fb a_ eD ee a_ ed eC eb eD ec eh eC ef aA a_ fh eD fd a_ ff eh eA eA a_ eC ed fe ed fa a_ ee eh eC ec a_ eg ed fa a_ eh eC a_ fc eh eB ed aC _? _? c` ee fc ed fa a_ e` eA eA a_ fh eD fd a_ ec eh ec a_ fc eD a_ eB ed aA a_ ch a_ fc e` e@ ed a_ fb eD a_ eB fd eb eg a_ ed eC e? eD fh eB ed eC fc a_ ee fa eD eB a_ e@ eC eD ff eh eC ef a_ eg eD ff a_ fh eD fd af fa ed a_ fb fc e` fa eh eC ef a_ e` fc a_ fc eg eh fb a_ eB ed fb fb e` ef ed aC a_ c@ eC eD ff eh eC ef a_ fc eg e` fc a_ fc eg ed a_ e` eC fb ff ed fa a_ eA eh ed fb a_ ff eh fc eg eh eC aA a_ fh ed fc a_ eb eD eB f_ eA ed fc ed eA fh a_ f_ eD ff ed fa eA ed fb fb a_ fc eD a_ ee eh eC ec a_ eh fc aC a_ db eD a_ e` fb a_ f_ fa eD eB eh fb ed ec aA a_ eg ed fa ed a_ eh fb a_ fh eD fd fa a_ ec e` fd ef eg fc ed fa b? a_ eh eC eb eg ed ec aC ea e` fa eB e` eC aC ee e` fb fc a_ cf eD eD ec a_ eA fd eb e@ a_ ee eh eC ec eh eC ef a_ fd fb a_ eh eC a_ fc eh eB ed aA a_ fb eg ed af fb a_ ff eh fc eg a_ eB ed a_ e@ eC eD ff aC a_ cb fa fh eh eC ef a_ ee eD fa a_ fb eD eB ed eD eC ed a_ fc eD a_ ee eh eC ec a_ eg ed fa aA a_ ff eg eh eb eg a_ fh eD fd a_ ff eh eA eA aA a_ eh eC a_ f_ eh ed eb ed fb aC a_ d_ eh ed eb ed fb a_ eb fa ed e` fc ed ec a_ eD fd fc a_ eD ee a_ eg ed fa a_ ee eA ed fb eg a_ ff eg eh eA ed a_ fb eg ed a_ ff e` fb a_ fb fc eh eA eA a_ e` eA eh fe ed aC a_ dc eg e` fc af fb a_ ff eg e` fc a_ fh eD fd a_ ef ed fc a_ ee eD fa a_ fc eg ed a_ eg eD fa fa eD fa fb a_ fh eD fd a_ f_ fd fc a_ eB ed a_ e` eC ec a_ eB fh a_ ee e` eB eh eA fh a_ fc eg fa eD fd ef eg aC _? _? ce fd eb e@ a_ fh eD fd aA a_ cB fa a_ c` eC ec ed fa fb eD eC aC
```

This is the result, as we can see, now we have another format: Is ROT-47.

### Deciphering from ROT-47
Like we done with the previous format, we have to decode again now with ROT-47, I'll use: _https://www.browserling.com/tools/rot47_:

![ROT-47](https://github.com/user-attachments/assets/dcac613a-635a-486c-bd4e-e4453bced859)

Full text decode from ROT-47:
```
44 65 61 72 20 4q 72 2r 20 41 6r 64 65 72 73 6s 6r 2p 0n 0n 41 73 20 79 6s 75 20 6q 61 79 20 6o 6r 6s 77 2p 20 49 20 68 61 76 65 20 79 6s 75 72 20 64 61 75 67 68 74 65 72 2r 20 49 6r 20 74 68 65 20 6r 65 78 74 20 32 34 20 68 6s 75 72 73 2p 20 73 68 65 20 77 69 6p 6p 20 62 65 20 6o 69 6p 6p 65 64 20 69 6r 20 74 68 65 20 6q 6s 73 74 20 67 72 75 65 73 6s 6q 65 20 77 61 79 20 69 6q 61 67 69 6r 61 62 6p 65 2r 20 49 20 6o 6r 6s 77 20 77 68 61 74 20 79 6s 75 20 64 69 64 20 74 6s 20 6q 65 20 61 6r 64 20 6q 79 20 66 61 6q 69 6p 79 20 69 6r 20 49 72 61 71 2p 20 61 6r 64 20 73 6s 20 64 6s 20 79 6s 75 2r 20 54 68 65 20 66 75 6r 6r 79 20 74 68 69 6r 67 20 69 73 2p 20 65 76 65 6r 20 74 68 6s 75 67 68 20 79 6s 75 27 72 65 20 73 74 61 72 69 6r 67 20 61 74 20 74 68 69 73 20 65 78 61 63 74 20 74 65 78 74 2p 20 77 68 69 63 68 20 74 65 6p 6p 73 20 79 6s 75 20 65 78 61 63 74 6p 79 20 77 68 65 72 65 20 79 6s 75 72 20 64 61 75 67 68 74 65 72 20 69 73 2r 20 54 68 72 6s 75 67 68 20 61 6p 6p 20 74 68 65 20 6p 61 79 65 72 73 20 6s 66 20 65 6r 63 6s 64 69 6r 67 2p 20 79 6s 75 20 77 69 6p 6p 20 6r 65 76 65 72 20 66 69 6r 64 20 68 65 72 20 69 6r 20 74 69 6q 65 2r 0n 0n 41 66 74 65 72 20 61 6p 6p 20 79 6s 75 20 64 69 64 20 74 6s 20 6q 65 2p 20 49 20 74 61 6o 65 20 73 6s 20 6q 75 63 68 20 65 6r 6n 6s 79 6q 65 6r 74 20 66 72 6s 6q 20 6o 6r 6s 77 69 6r 67 20 68 6s 77 20 79 6s 75 27 72 65 20 73 74 61 72 69 6r 67 20 61 74 20 74 68 69 73 20 6q 65 73 73 61 67 65 2r 20 4o 6r 6s 77 69 6r 67 20 74 68 61 74 20 74 68 65 20 61 6r 73 77 65 72 20 6p 69 65 73 20 77 69 74 68 69 6r 2p 20 79 65 74 20 63 6s 6q 70 6p 65 74 65 6p 79 20 70 6s 77 65 72 6p 65 73 73 20 74 6s 20 66 69 6r 64 20 69 74 2r 20 53 6s 20 61 73 20 70 72 6s 6q 69 73 65 64 2p 20 68 65 72 65 20 69 73 20 79 6s 75 72 20 64 61 75 67 68 74 65 72 3n 20 69 6r 63 68 65 64 2r 62 61 72 6q 61 6r 2r 66 61 73 74 20 47 6s 6s 64 20 6p 75 63 6o 20 66 69 6r 64 69 6r 67 20 75 73 20 69 6r 20 74 69 6q 65 2p 20 73 68 65 27 73 20 77 69 74 68 20 6q 65 20 6o 6r 6s 77 2r 20 43 72 79 69 6r 67 20 66 6s 72 20 73 6s 6q 65 6s 6r 65 20 74 6s 20 66 69 6r 64 20 68 65 72 2p 20 77 68 69 63 68 20 79 6s 75 20 77 69 6p 6p 2p 20 69 6r 20 70 69 65 63 65 73 2r 20 50 69 65 63 65 73 20 63 72 65 61 74 65 64 20 6s 75 74 20 6s 66 20 68 65 72 20 66 6p 65 73 68 20 77 68 69 6p 65 20 73 68 65 20 77 61 73 20 73 74 69 6p 6p 20 61 6p 69 76 65 2r 20 54 68 61 74 27 73 20 77 68 61 74 20 79 6s 75 20 67 65 74 20 66 6s 72 20 74 68 65 20 68 6s 72 72 6s 72 73 20 79 6s 75 20 70 75 74 20 6q 65 20 61 6r 64 20 6q 79 20 66 61 6q 69 6p 79 20 74 68 72 6s 75 67 68 2r 0n 0n 46 75 63 6o 20 79 6s 75 2p 20 4q 72 20 41 6r 64 65 72 73 6s 6r 2r
```

### Deciphering from Hexadecimal

Again, we have now another format, this time is Hexadecimal, let's decipher it:

![Bad result](https://github.com/user-attachments/assets/5cee0406-5b1e-4147-b01a-3f6dc6d65180)

Something's wrong here, we can see fragments of the message but it cannot be fully deciphered, because if we see the text it have been altered and the autor put another letter: "44 65 61 72 20 **4q** 72 **2r** 20 41 **6r** 64 65 72..."

### Guessing the changed letters

By the result, we can predict the author has hidden some specific letters, like the "o", "n", "l", etc.


To guess the data than the author has altered, we can try to decipher the text in fragments, I'll use this fragment: "44 65 61 72 20 4q 72 2r 20 41 6r 64 65 72 73 6s 6r":

![Test](https://github.com/user-attachments/assets/584fc089-a288-46d6-8013-c7733bc83344)

We can predict the text could be: "Dear Mr. Anderson". Now we'll try translating our prediction in hexadecimal and see if the strings are similar:

![Test 2](https://github.com/user-attachments/assets/a9649e39-625e-4114-8d6c-29b8b42e826c)

Now we have to compare our strings:

```
Original: 44 65 61 72 20 4q 72 2r 20 41 6r 64 65 72 73 6s 6r
```

```
Our prediction: 44 65 61 72 20 4d 72 2e 20 41 6e 64 65 72 73 6f 6e
```

Comparing the results, we can see the letter than the author changed in the message:

1. q = d
2. r = e
3. s = f

We have a few letters, but we need more so, let's try again this technique with another fragment: "44 65 61 72 20 4q 72 2r 20 41 6r 64 65 72 73 6s 6r 2p 0n 0n 41 73 20 79 6s 75 20 6q 61 79 20 6o 6r 6s 77 2p 20 49 20 68 61 76 65 20 79 6s 75 72 20 64 61 75 67 68 74 65 72 2r 20 49 6r 20 74 68 65 20 6r 65 78 74 20 32 34 20 68 6s 75 72 73 2p 20 73 68 65 20 77 69 6p 6p 20 62 65"

![Test 3](https://github.com/user-attachments/assets/88b75275-049a-47f2-b6b6-4f2eb7e3b5af)

We can predict the text could be: "Dear Mr. Anderson... As you may know. I have your daughter. In the next 24 hours. she will be..."

Like we done with the previous fragment, let's translate our prediction in hexadecimal and compare the strings:

```
Original: 44 65 61 72 20 4q 72 2r 20 41 6r 64 65 72 73 6s 6r 2p 0n 0n 41 73 20 79 6s 75 20 6q 61 79 20 6o 6r 6s 77 2p 20 49 20 68 61 76 65 20 79 6s 75 72 20 64 61 75 67 68 74 65 72 2r 20 49 6r 20 74 68 65 20 6r 65 78 74 20 32 34 20 68 6s 75 72 73 2p 20 73 68 65 20 77 69 6p 6p 20 62 65
```

```
Our prediction: 44 65 61 72 20 4d 72 2e 20 41 6e 64 65 72 73 6f 6e 2e 2e 2e 20 41 73 20 79 6f 75 20 6d 61 79 20 6b 6e 6f 77 2e 20 49 20 68 61 76 65 20 79 6f 75 72 20 64 61 75 67 68 74 65 72 2e 20 49 6e 20 74 68 65 20 6e 65 78 74 20 32 34 20 68 6f 75 72 73 2e 20 73 68 65 20 77 69 6c 6c 20 62 65 2e 2e 2e
```

After the comparation, we can find 3 letters more that have been changed:

4. p = c
5. n = e
6. o = b

We can replace the letters with notepad using the tool "Replace" and deciphering again, now with the changes:

![Result](https://github.com/user-attachments/assets/9fdd1ec5-18d8-4df8-9cfa-7b22bfa3a026)

We have decoded the message, now we can read it and get our flag:

> Flag: inched.barman.fast
